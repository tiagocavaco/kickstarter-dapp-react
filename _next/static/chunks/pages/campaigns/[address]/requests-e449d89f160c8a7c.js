(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[544],{39229:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/campaigns/[address]/requests",function(){return r(67608)}])},91986:function(e,n,r){"use strict";var t=r(34051),s=r.n(t),a=r(97378),c=r(24644);function i(e,n,r,t,s,a,c){try{var i=e[a](c),o=i.value}catch(u){return void r(u)}i.done?n(o):Promise.resolve(o).then(t,s)}function o(e){return function(){var n=this,r=arguments;return new Promise((function(t,s){var a=e.apply(n,r);function c(e){i(a,t,s,c,o,"next",e)}function o(e){i(a,t,s,c,o,"throw",e)}c(void 0)}))}}n.Z=function(){var e=(0,a.bN)(),n=e.globalState,r=e.dispatch,t=n.web3,i=n.address,u=function(){var e=o(s().mark((function e(){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.eth.getBalance(i);case 2:n=e.sent,r({type:"SET_GLOBAL_STATE",values:{balance:(0,c.CG)(n)}});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{refreshBalance:u}}},67608:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return g}});var t=r(34051),s=r.n(t),a=r(85893),c=r(67294),i=r(41664),o=r(97378),u=r(2426),l=r(91986),d=r(24644),p=r(65927),f=r(25142),h=r(80967);function v(e,n,r,t,s,a,c){try{var i=e[a](c),o=i.value}catch(u){return void r(u)}i.done?n(o):Promise.resolve(o).then(t,s)}function x(e){return function(){var n=this,r=arguments;return new Promise((function(t,s){var a=e.apply(n,r);function c(e){v(a,t,s,c,i,"next",e)}function i(e){v(a,t,s,c,i,"throw",e)}c(void 0)}))}}var j=function(e){var n=(0,c.useState)(!1),r=n[0],t=n[1],i=(0,c.useState)(!1),v=i[0],j=i[1],m=(0,u.Z)({address:e.address}).campaignContract,C=(0,l.Z)().refreshBalance,Z=(0,o.bN)().globalState,w=Z.connected,b=Z.address,y=e.id,g=e.request,S=e.approversCount,k=e.refreshRequests,E=g.approvalCount>S/2,q=function(){var e=x(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(!0),e.prev=1,e.next=4,m.methods.approveRequest(y).send({from:b});case 4:k(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0);case 10:return e.prev=10,C(),t(!1),e.finish(10);case 14:case"end":return e.stop()}}),e,null,[[1,7,10,14]])})));return function(){return e.apply(this,arguments)}}(),_=function(){var e=x(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),e.prev=1,e.next=4,m.methods.finalizeRequest(y).send({from:b});case 4:k(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0);case 10:return e.prev=10,C(),j(!1),e.finish(10);case 14:case"end":return e.stop()}}),e,null,[[1,7,10,14]])})));return function(){return e.apply(this,arguments)}}();return(0,a.jsxs)(p.Z.Row,{disabled:g.complete,positive:E&&!g.complete,children:[(0,a.jsx)(p.Z.Cell,{children:(0,a.jsx)(f.Z,{ribbon:!0,children:g.description})}),(0,a.jsx)(p.Z.Cell,{children:(0,a.jsxs)(f.Z,{color:"yellow",children:[(0,d.CG)(g.value),(0,a.jsx)(f.Z.Detail,{children:"ETH"})]})}),(0,a.jsx)(p.Z.Cell,{children:g.recipient}),(0,a.jsx)(p.Z.Cell,{children:(0,a.jsxs)(f.Z,{circular:!0,basic:!0,children:[g.approvalCount,"/",S]})}),(0,a.jsx)(p.Z.Cell,{children:!g.complete&&(0,a.jsx)(h.Z,{disabled:!w||!m||v||r||E,loading:r,primary:!0,fluid:!0,onClick:q,children:"Approve"})}),(0,a.jsx)(p.Z.Cell,{children:!g.complete&&(0,a.jsx)(h.Z,{disabled:!w||!m||r||v||!E,loading:v,secondary:!0,fluid:!0,onClick:_,children:"Finalize"})})]})},m=r(95712),C=r(57417),Z=r(40849);function w(e,n,r,t,s,a,c){try{var i=e[a](c),o=i.value}catch(u){return void r(u)}i.done?n(o):Promise.resolve(o).then(t,s)}function b(e){return function(){var n=this,r=arguments;return new Promise((function(t,s){var a=e.apply(n,r);function c(e){w(a,t,s,c,i,"next",e)}function i(e){w(a,t,s,c,i,"throw",e)}c(void 0)}))}}var y=function(e){var n=(0,c.useState)([]),r=n[0],t=n[1],l=(0,c.useState)(0),d=l[0],f=l[1],v=(0,c.useState)(0),x=v[0],w=v[1],y=(0,c.useState)(!0),g=y[0],S=y[1],k=(0,u.Z)({address:e.address}).campaignContract;(0,o.bN)().globalState.connected;(0,c.useEffect)((function(){E()}),[k]);var E=function(){var e=b(s().mark((function e(){var n,r,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("GET CAMPAIGN REQUESTS"),!k){e.next=25;break}return console.log("SET CAMPAIGN REQUESTS"),S(!0),e.prev=4,e.next=7,k.methods.getRequestsCount().call();case 7:return n=e.sent,e.next=10,k.methods.approversCount().call();case 10:return r=e.sent,e.next=13,Promise.all(Array(parseInt(n)).fill().map((function(e,n){return k.methods.requests(n).call()})));case 13:a=e.sent,f(n),w(r),t(a),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(4),console.log(e.t0);case 22:return e.prev=22,S(!1),e.finish(22);case 25:case"end":return e.stop()}}),e,null,[[4,19,22,25]])})));return function(){return e.apply(this,arguments)}}();return(0,a.jsxs)(m.Z,{children:[(0,a.jsx)(i.default,{href:"/campaigns/".concat(e.address),children:(0,a.jsx)("a",{children:"< Back"})}),(0,a.jsx)("h3",{children:"Campaign Requests"}),(0,a.jsx)(i.default,{href:"/campaigns/".concat(e.address,"/requests/new"),children:(0,a.jsx)("a",{children:(0,a.jsx)(h.Z,{primary:!0,children:"Create Request"})})}),(0,a.jsxs)("div",{style:{position:"relative"},children:[(0,a.jsx)(C.Z,{active:g,inverted:!0,children:(0,a.jsx)(Z.Z,{})}),(0,a.jsxs)(p.Z,{striped:!0,basic:"very",children:[(0,a.jsx)(p.Z.Header,{children:(0,a.jsxs)(p.Z.Row,{children:[(0,a.jsx)(p.Z.HeaderCell,{children:"Description"}),(0,a.jsx)(p.Z.HeaderCell,{children:"Amount"}),(0,a.jsx)(p.Z.HeaderCell,{children:"Recipient"}),(0,a.jsx)(p.Z.HeaderCell,{children:"Approval Count"}),(0,a.jsx)(p.Z.HeaderCell,{colSpan:"2",children:"Actions"})]})}),(0,a.jsx)(p.Z.Body,{children:r.map((function(n,r){return(0,a.jsx)(j,{id:r,request:n,address:e.address,approversCount:x,refreshRequests:E},r)}))})]}),(0,a.jsxs)("div",{children:["Found ",(0,a.jsx)("strong",{children:d})," requests."]})]})]})};y.getInitialProps=function(){var e=b(s().mark((function e(n){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.query,e.abrupt("return",{address:r.address});case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();var g=y}},function(e){e.O(0,[595,426,774,888,179],(function(){return n=39229,e(e.s=n);var n}));var n=e.O();_N_E=n}]);